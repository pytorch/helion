This file is automatically generated by assertExpectedJournal calls in test_pallas.py.
Update expected outputs by running tests with the EXPECTTEST_ACCEPT=1 environment variable set.

--- assertExpectedJournal(TestPallas.test_add_1d)
from __future__ import annotations

import math
import torch
from helion.runtime import default_pallas_launcher as _default_pallas_launcher

def _helion_add_kernel(x, y, out):
    # src[test_pallas.py:N]: out[tile] = x[tile] + y[tile]
    load = x[...]
    load_1 = y[...]
    v_0 = load + load_1
    out[...] = v_0

def add_kernel(x: torch.Tensor, y: torch.Tensor, *, _launcher=_default_pallas_launcher):
    # src[test_pallas.py:N]: x, y = torch.broadcast_tensors(x, y)
    x, y = torch.broadcast_tensors(x, y)
    # src[test_pallas.py:N]: out = torch.empty_like(x)
    out = torch.empty_like(x)
    # src[test_pallas.py:N]: for tile in hl.tile(out.size()):
    _BLOCK_SIZE_0 = 256
    # src[test_pallas.py:N]: for tile in hl.tile(out.size()):
    # src[test_pallas.py:N]:     out[tile] = x[tile] + y[tile]
    _launcher(_helion_add_kernel, (math.ceil(1024 / _BLOCK_SIZE_0),), x, y, out, _BLOCK_SIZE_0)
    # src[test_pallas.py:N]: return out
    return out

--- assertExpectedJournal(TestPallas.test_add_large)
from __future__ import annotations

import math
import torch
from helion.runtime import default_pallas_launcher as _default_pallas_launcher

def _helion_add_kernel(x, y, out):
    # src[test_pallas.py:N]: out[tile] = x[tile] + y[tile]
    load = x[...]
    load_1 = y[...]
    v_0 = load + load_1
    out[...] = v_0

def add_kernel(x: torch.Tensor, y: torch.Tensor, *, _launcher=_default_pallas_launcher):
    # src[test_pallas.py:N]: x, y = torch.broadcast_tensors(x, y)
    x, y = torch.broadcast_tensors(x, y)
    # src[test_pallas.py:N]: out = torch.empty_like(x)
    out = torch.empty_like(x)
    # src[test_pallas.py:N]: for tile in hl.tile(out.size()):
    _BLOCK_SIZE_0 = 512
    # src[test_pallas.py:N]: for tile in hl.tile(out.size()):
    # src[test_pallas.py:N]:     out[tile] = x[tile] + y[tile]
    _launcher(_helion_add_kernel, (math.ceil(4096 / _BLOCK_SIZE_0),), x, y, out, _BLOCK_SIZE_0)
    # src[test_pallas.py:N]: return out
    return out
