This file is automatically generated by assertExpectedJournal calls in test_shape_bucketing.py.
Update expected outputs by running tests with the EXPECTTEST_ACCEPT=1 environment variable set.

--- assertExpectedJournal(TestShapeBucketing.test_zero_nonzero_codegen_identical_m1_vs_m2)
from __future__ import annotations

import torch
import triton
import triton.language as tl
from helion.runtime import default_launcher as _default_launcher

import test.test_shape_bucketing as _source_module

@triton.jit
def _helion_pw_add_fn(x, out, x_size_1, out_stride_0, out_stride_1, x_stride_0, x_stride_1):
    # src[test_shape_bucketing.py:N]: for i in grid(x.size(0)):
    pid_0 = tl.program_id(0)
    offset_0 = pid_0
    # src[test_shape_bucketing.py:N]: for j in grid(x.size(1)):
    # src[test_shape_bucketing.py:N]:     out[i, j] = x[i, j] + 1.0
    for offset_1 in tl.range(0, x_size_1):
        # src[test_shape_bucketing.py:N]: out[i, j] = x[i, j] + 1.0
        load = tl.load(x + (offset_0 * x_stride_0 + offset_1 * x_stride_1), None)
        v_0 = 1.0
        v_1 = load + v_0
        tl.store(out + (offset_0 * out_stride_0 + offset_1 * out_stride_1), v_1, None)

def pw_add_fn(x: torch.Tensor, out: torch.Tensor, *, _launcher=_default_launcher):
    # src[test_shape_bucketing.py:N]: for i in grid(x.size(0)):
    # src[test_shape_bucketing.py:N]:     for j in grid(x.size(1)):
    # src[test_shape_bucketing.py:N]:         out[i, j] = x[i, j] + 1.0
    _launcher(_helion_pw_add_fn, (x.size(0),), x, out, x.size(1), out.stride(0), out.stride(1), x.stride(0), x.stride(1), num_warps=4, num_stages=1)

--- assertExpectedJournal(TestShapeBucketing.test_zero_nonzero_codegen_identical_m1_vs_m2)
from __future__ import annotations

import torch
import triton
import triton.language as tl
from helion.runtime import default_launcher as _default_launcher

import test.test_shape_bucketing as _source_module

@triton.jit
def _helion_pw_add_fn(x, out, x_size_1, out_stride_0, out_stride_1, x_stride_0, x_stride_1):
    # src[test_shape_bucketing.py:N]: for i in grid(x.size(0)):
    pid_0 = tl.program_id(0)
    offset_0 = pid_0
    # src[test_shape_bucketing.py:N]: for j in grid(x.size(1)):
    # src[test_shape_bucketing.py:N]:     out[i, j] = x[i, j] + 1.0
    for offset_1 in tl.range(0, x_size_1):
        # src[test_shape_bucketing.py:N]: out[i, j] = x[i, j] + 1.0
        load = tl.load(x + (offset_0 * x_stride_0 + offset_1 * x_stride_1), None)
        v_0 = 1.0
        v_1 = load + v_0
        tl.store(out + (offset_0 * out_stride_0 + offset_1 * out_stride_1), v_1, None)

def pw_add_fn(x: torch.Tensor, out: torch.Tensor, *, _launcher=_default_launcher):
    # src[test_shape_bucketing.py:N]: for i in grid(x.size(0)):
    # src[test_shape_bucketing.py:N]:     for j in grid(x.size(1)):
    # src[test_shape_bucketing.py:N]:         out[i, j] = x[i, j] + 1.0
    _launcher(_helion_pw_add_fn, (x.size(0),), x, out, x.size(1), out.stride(0), out.stride(1), x.stride(0), x.stride(1), num_warps=4, num_stages=1)
